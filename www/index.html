<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Astrax â€¢ Module</title>
    
    <style>
        @import "https://mui.kernelsu.org/internal/insets.css";
        @import "https://mui.kernelsu.org/internal/colors.css";
    </style>

    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400..700,1,0" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        :root {
            /* Optimized Dark Theme - Deep Blue with Neon Accents */
            --md-bg: #0B1120; 
            --md-on-bg: #F0F4FF;
            --md-surface: #0F172A;
            --md-surface-container: #1E293B; 
            --md-surface-container-high: #2D3A4F;
            --md-primary: #7C9EFF;
            --md-primary-container: #2D3A6B; 
            --md-on-primary-container: #E2EBFF;
            --md-secondary-container: #334155;
            --md-on-secondary-container: #F1F5F9;
            --md-error-container: #450A0A;
            --md-on-error-container: #FEE2E2;
            --md-error: #FF6B6B;
            --md-success: #6EDC9A;
            --md-outline: #94A3B8;
            --md-surface-variant: #1E2A3A;
            --md-surface-glass: rgba(30, 41, 59, 0.8);
            --md-surface-glass-high: rgba(45, 58, 79, 0.8);
            --md-shadow: rgba(0, 0, 0, 0.5);
            --anim-curve: cubic-bezier(0.2, 0, 0, 1); 
            --anim-duration: 0.2s;
            --pop-curve: cubic-bezier(0.175, 0.885, 0.32, 1.275);
            
            /* Outline colors */
            --outline-light: rgba(124, 158, 255, 0.3);
            --outline-dark: rgba(37, 99, 235, 0.2);
        }

        /* Optimized Light Theme - Clean White with Subtle Blue */
        .light-mode {
            --md-bg: #F8FAFC; 
            --md-on-bg: #0F172A;
            --md-surface: #FFFFFF;
            --md-surface-container: #F1F5F9; 
            --md-surface-container-high: #E2E8F0;
            --md-primary: #2563EB;
            --md-primary-container: #DBEAFE; 
            --md-on-primary-container: #1E3A8A;
            --md-secondary-container: #E2E8F0;
            --md-on-secondary-container: #334155;
            --md-error-container: #FEE2E2;
            --md-on-error-container: #991B1B;
            --md-error: #DC2626;
            --md-success: #16A34A;
            --md-outline: #64748B;
            --md-surface-variant: #F1F5F9;
            --md-surface-glass: rgba(255, 255, 255, 0.7);
            --md-surface-glass-high: rgba(226, 232, 240, 0.7);
            --md-shadow: rgba(0, 0, 0, 0.1);
            
            /* Outline colors for light mode */
            --outline-light: rgba(37, 99, 235, 0.2);
            --outline-dark: rgba(124, 158, 255, 0.3);
        }

        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
            outline: none; 
        }
        
        body {
            background-color: var(--md-bg); 
            color: var(--md-on-bg);
            font-family: 'Google Sans', sans-serif; 
            min-height: 100vh;
            display: flex; 
            flex-direction: column; 
            user-select: none;
            transition: background-color 0.2s ease, color 0.2s ease;
            overflow-x: hidden;
            position: relative;
        }

        /* Splash Screen dengan animasi fade */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--md-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.3s ease, transform 0.3s ease;
            opacity: 1;
            transform: scale(1);
            will-change: opacity, transform;
        }
        .splash-screen.hide {
            opacity: 0;
            transform: scale(0.95);
        }
        .splash-content {
            text-align: center;
            animation: fadeScale 0.3s ease-out;
        }
        .splash-content h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--md-primary), #b8ccff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-top: 12px;
        }
        .splash-content .material-symbols-rounded {
            font-size: 48px;
            color: var(--md-primary);
            font-variation-settings: 'FILL' 1;
            animation: pulse 1s infinite;
        }
        @keyframes fadeScale {
            0% { opacity: 0; transform: scale(0.9); }
            100% { opacity: 1; transform: scale(1); }
        }
        @keyframes pulse {
            0% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
            100% { opacity: 0.8; transform: scale(1); }
        }

        .top-app-bar {
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0; 
            z-index: 1000; 
            background-color: var(--md-bg);
            padding-top: var(--window-inset-top, 0px);
            height: auto; 
            min-height: 70px; 
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            padding-left: 20px; 
            padding-right: 20px; 
            padding-bottom: 8px;
            transition: background-color 0.2s ease;
        }
        .header-branding { 
            display: flex; 
            align-items: center; 
            gap: 6px; 
            height: 50px; 
        }
        .app-logo { 
            font-size: 28px; 
            color: var(--md-primary); 
            font-variation-settings: 'FILL' 1, 'wght' 700; 
            animation: glowPulse 3s ease-in-out infinite;
            text-shadow: 0 0 10px rgba(124, 158, 255, 0.5);
        }
        @keyframes glowPulse {
            0% { text-shadow: 0 0 5px rgba(124, 158, 255, 0.3); }
            50% { text-shadow: 0 0 20px rgba(124, 158, 255, 0.8), 0 0 30px rgba(124, 158, 255, 0.5); }
            100% { text-shadow: 0 0 5px rgba(124, 158, 255, 0.3); }
        }
        .app-title { 
            font-size: 28px; 
            font-weight: 700; 
            letter-spacing: -0.5px; 
        }
        .beta-tag {
            font-size: 12px;
            color: var(--md-outline);
            margin-left: 4px;
            font-weight: 400;
            letter-spacing: 0.3px;
            background: var(--md-surface-container);
            padding: 2px 6px;
            border-radius: 100px;
            border: 1px solid var(--md-outline);
        }

        .dashboard-btn {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background-color: var(--md-surface-container-high);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.1s, background-color 0.15s;
            flex-shrink: 0;
            box-shadow: 0 2px 8px var(--md-shadow);
        }
        .dashboard-btn:active { transform: scale(0.9); }
        .dashboard-btn .material-symbols-rounded {
            color: var(--md-primary);
            font-size: 24px;
            font-variation-settings: 'FILL' 1;
            transition: transform 0.2s var(--anim-curve);
        }
        .dashboard-btn.active .material-symbols-rounded {
            transform: rotate(180deg);
        }

        .theme-toggle-btn {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background-color: var(--md-surface-container-high);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.1s, background-color 0.15s;
            flex-shrink: 0;
            box-shadow: 0 2px 8px var(--md-shadow);
            position: relative;
            z-index: 10001;
        }
        .theme-toggle-btn:active { transform: scale(0.9); }
        .theme-toggle-btn .material-symbols-rounded {
            color: var(--md-primary);
            font-size: 24px;
            font-variation-settings: 'FILL' 1;
        }

        /* Header Actions */
        .header-actions {
            display: flex;
            gap: 6px;
        }

        /* Dashboard Panel */
        .dashboard-panel {
            position: fixed;
            top: calc(70px + var(--window-inset-top, 0px));
            left: 0;
            right: 0;
            background-color: var(--md-surface-glass);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--md-outline);
            z-index: 900;
            transform: translateY(-100%);
            transition: transform 0.2s var(--anim-curve);
            padding: 16px;
            border-bottom-left-radius: 24px;
            border-bottom-right-radius: 24px;
            box-shadow: 0 4px 20px var(--md-shadow);
        }
        .dashboard-panel.open {
            transform: translateY(0);
        }
        .dashboard-header {
            margin-bottom: 16px;
        }
        .dashboard-header h2 {
            font-size: 22px;
            font-weight: 600;
            background: linear-gradient(135deg, var(--md-primary), #b8ccff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        .dashboard-item {
            background-color: var(--md-surface-glass-high);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-radius: 18px;
            padding: 14px 8px;
            text-align: center;
            border: 1px solid var(--md-outline);
            transition: transform 0.15s var(--anim-curve);
            box-shadow: 0 2px 8px var(--md-shadow);
        }
        .dashboard-item:active {
            transform: scale(0.95);
        }
        .dashboard-item .material-symbols-rounded {
            font-size: 28px;
            color: var(--md-primary);
            margin-bottom: 4px;
        }
        .dashboard-item .value {
            font-size: 18px;
            font-weight: 700;
            color: var(--md-primary);
            margin-bottom: 2px;
            text-transform: capitalize;
        }
        .dashboard-item .label {
            font-size: 11px;
            color: var(--md-outline);
            text-transform: capitalize;
            letter-spacing: 0.3px;
        }

        /* Icon Tidur untuk Battery */
        .icon-sleep {
            animation: sleepPulse 4s ease-in-out infinite;
        }
        @keyframes sleepPulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .main-content {
            flex: 1;
            margin-top: calc(70px + var(--window-inset-top, 0px));
            padding: 12px 16px;
            padding-bottom: calc(80px + var(--window-inset-bottom, 0px));
            overflow-x: hidden;
            overflow-y: auto;
            position: relative;
            transition: margin-top 0.2s var(--anim-curve);
            height: calc(100vh - 70px - var(--window-inset-top, 0px));
            -webkit-overflow-scrolling: touch;
        }
        .main-content.dashboard-open {
            margin-top: calc(240px + var(--window-inset-top, 0px));
        }

        /* Tab Container untuk Swipe */
        .tab-container {
            width: 100%;
            overflow: hidden;
            position: relative;
            background-color: transparent;
            height: 100%;
        }
        
        .tabs-wrapper {
            display: flex;
            width: 100%;
            height: 100%;
            transition: transform 0.2s cubic-bezier(0.2, 0, 0.2, 1);
            will-change: transform;
        }
        
        .tab-section { 
            flex: 0 0 100%;
            display: block;
            flex-direction: column; 
            gap: 12px; 
            width: 100%; 
            will-change: opacity;
            opacity: 1;
            padding: 0;
            overflow-y: auto;
            height: 100%;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        /* Halaman settings dengan scroll */
        #settings.tab-section {
            overflow-y: auto;
        }

        /* Section Headers */
        .section-header {
            font-size: 20px;
            font-weight: 700;
            color: var(--md-primary);
            margin: 16px 0 12px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--md-outline);
            letter-spacing: -0.3px;
            background: linear-gradient(135deg, var(--md-primary), #b8ccff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
            text-transform: capitalize;
        }

        /* Empty State */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 200px;
            color: var(--md-outline);
            text-align: center;
        }
        .empty-state .material-symbols-rounded {
            font-size: 48px;
            margin-bottom: 12px;
            color: var(--md-outline);
        }
        .empty-state p {
            font-size: 14px;
        }

        /* Banner Hero dengan animasi smooth */
        .banner-hero {
            width: 100%;
            height: 160px;
            border-radius: 24px;
            background-image: var(--banner-url);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            box-shadow: 0 8px 20px var(--md-shadow);
            transition: background-image 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
            margin-bottom: 12px;
        }
        
        .banner-hero::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.05) 50%, transparent 100%);
            border-radius: 24px;
            pointer-events: none;
            z-index: 1;
        }
        
        .custom-banner-btn-banner {
            position: absolute;
            right: 16px;
            bottom: 16px;
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background-color: var(--md-surface-glass-high);
            backdrop-filter: blur(8px);
            border: 1px solid var(--md-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.1s, background-color 0.15s;
            z-index: 3;
            box-shadow: 0 2px 8px var(--md-shadow);
        }
        .custom-banner-btn-banner:active { transform: scale(0.9); }
        .custom-banner-btn-banner .material-symbols-rounded {
            color: var(--md-primary);
            font-size: 22px;
            font-variation-settings: 'FILL' 1;
        }

        /* Device Info Card - Kembali ke versi sebelumnya */
        .device-info-card {
            background: linear-gradient(145deg, var(--md-surface-container), var(--md-surface-container-high));
            border-radius: 22px;
            padding: 16px;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--md-outline);
            box-shadow: 0 6px 16px var(--md-shadow);
            animation: slideUp 0.5s ease-out;
            width: 100%;
        }
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .device-info-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, var(--md-primary) 0%, transparent 70%);
            opacity: 0.05;
            pointer-events: none;
        }
        .device-info-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 14px;
        }
        .device-info-icon {
            width: 44px;
            height: 44px;
            border-radius: 14px;
            background: linear-gradient(135deg, var(--md-primary), var(--md-primary-container));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }
        .device-info-title {
            font-size: 18px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--md-primary), #b8ccff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: capitalize;
        }
        .device-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        .device-info-item {
            background-color: var(--md-surface-glass);
            backdrop-filter: blur(4px);
            border-radius: 14px;
            padding: 10px;
            border: 1px solid var(--md-outline);
        }
        .device-info-label {
            font-size: 9px;
            color: var(--md-outline);
            text-transform: uppercase;
            margin-bottom: 2px;
            letter-spacing: 0.3px;
        }
        .device-info-value {
            font-size: 13px;
            font-weight: 600;
            color: var(--md-primary);
            word-break: break-word;
        }

        /* Cards */
        .card {
            background-color: var(--md-surface-container);
            border-radius: 22px;
            padding: 16px;
            transition: background-color 0.2s ease, transform 0.1s linear, box-shadow 0.15s;
            margin-bottom: 10px;
            width: 100%;
            box-shadow: 0 4px 12px var(--md-shadow);
            border: 1px solid var(--md-outline);
            outline: 1px solid var(--outline-light);
            outline-offset: -1px;
        }
        .light-mode .card {
            outline-color: var(--outline-dark);
        }
        .clickable-item {
            cursor: pointer;
        }
        .clickable-item:active { 
            transform: scale(0.98); 
        }

        /* Feature Cards */
        .feature-card {
            background-color: var(--md-surface-container);
            border-radius: 22px;
            padding: 16px;
            margin-bottom: 10px;
            width: 100%;
            box-shadow: 0 4px 12px var(--md-shadow);
            transition: background-color 0.2s ease;
            border: 1px solid var(--md-outline);
            outline: 1px solid var(--outline-light);
            outline-offset: -1px;
        }
        .light-mode .feature-card {
            outline-color: var(--outline-dark);
        }
        .feature-header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 10px;
        }
        .feature-icon-large {
            width: 48px;
            height: 48px;
            border-radius: 16px;
            background-color: var(--md-primary-container);
            color: var(--md-on-primary-container);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: background-color 0.2s ease;
        }
        .feature-icon-large .material-symbols-rounded {
            font-size: 28px;
            font-variation-settings: 'FILL' 1;
        }
        .feature-title-large {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 2px;
            text-transform: capitalize;
        }
        .feature-desc-large {
            font-size: 13px;
            color: var(--md-outline);
            line-height: 1.4;
            text-transform: capitalize;
        }
        .feature-description-box {
            background-color: var(--md-surface-variant);
            border-radius: 18px;
            padding: 12px 14px;
            margin: 8px 0;
            font-size: 13px;
            color: var(--md-on-bg);
            border-left: 4px solid var(--md-primary);
            line-height: 1.5;
            width: 100%;
            transition: background-color 0.2s ease;
            border: 1px solid var(--md-outline);
            outline: 1px solid var(--outline-light);
            outline-offset: -1px;
        }
        .light-mode .feature-description-box {
            outline-color: var(--outline-dark);
        }
        .feature-description-box .material-symbols-rounded {
            color: var(--md-primary);
            font-size: 16px;
            vertical-align: middle;
            margin-right: 4px;
        }
        .feature-benefit {
            margin-top: 8px;
            padding: 8px 12px;
            background-color: var(--md-surface-container-high);
            border-radius: 14px;
            font-size: 12px;
            color: var(--md-on-bg);
            transition: background-color 0.2s ease;
            border: 1px solid var(--md-outline);
            outline: 1px solid var(--outline-light);
            outline-offset: -1px;
        }
        .light-mode .feature-benefit {
            outline-color: var(--outline-dark);
        }
        .feature-benefit .material-symbols-rounded {
            font-size: 14px;
            color: var(--md-success);
            margin-right: 4px;
        }

        /* Settings Items */
        .settings-item { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 2px 0; 
        }
        .settings-left { 
            display: flex; 
            align-items: center; 
            gap: 16px; 
        }
        .settings-icon { 
            font-size: 26px; 
            color: var(--md-outline); 
        }
        .settings-text h3 { 
            font-size: 17px; 
            font-weight: 500; 
            margin-bottom: 2px;
            text-transform: capitalize;
        }
        .settings-text p { 
            font-size: 12px; 
            color: var(--md-outline); 
            text-transform: capitalize;
        }

        /* Expandable Cards */
        .expand-card {
            background-color: var(--md-surface-container);
            border-radius: 20px;
            padding: 14px;
            margin-top: 6px;
            width: 100%;
            box-shadow: 0 2px 8px var(--md-shadow);
            transition: background-color 0.2s ease;
            border: 1px solid var(--md-outline);
            outline: 1px solid var(--outline-light);
            outline-offset: -1px;
        }
        .light-mode .expand-card {
            outline-color: var(--outline-dark);
        }
        .expand-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
        }
        .expand-left {
            display: flex;
            align-items: center;
            gap: 14px;
        }
        .expand-icon {
            transition: transform 0.2s var(--anim-curve);
            color: var(--md-primary);
            font-size: 22px;
        }
        .expand-icon.rotated {
            transform: rotate(180deg);
        }
        .expand-content {
            overflow: hidden;
            max-height: 0;
            opacity: 0;
            transition: max-height 0.2s var(--anim-curve), opacity 0.15s ease, margin-top 0.15s ease;
            margin-top: 0;
        }
        .expand-content.show {
            max-height: 800px;
            opacity: 1;
            margin-top: 14px;
        }

        /* Input Groups */
        .md-input-group {
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: var(--md-surface-container-high);
            border-radius: 16px;
            padding: 4px 10px 4px 18px;
            border: 2px solid transparent;
            transition: border-color 0.15s, background-color 0.2s ease;
            margin-bottom: 10px;
        }
        .md-input-group:focus-within { 
            border-color: var(--md-primary); 
        }
        .md-input {
            flex: 1;
            background: transparent;
            border: none;
            padding: 12px 0;
            color: var(--md-on-bg);
            font-family: inherit;
            font-size: 15px;
            font-weight: 500;
        }

        /* Mode Selector */
        .mode-selector {
            display: flex;
            gap: 6px;
            margin: 12px 0;
            flex-wrap: wrap;
        }
        .mode-btn {
            flex: 1;
            min-width: 65px;
            background-color: var(--md-surface-container-high);
            border: 2px solid transparent;
            color: var(--md-on-bg);
            padding: 10px 6px;
            border-radius: 100px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s var(--anim-curve);
            text-align: center;
            box-shadow: 0 2px 4px var(--md-shadow);
            text-transform: capitalize;
        }
        .mode-btn.active {
            background-color: var(--md-primary-container);
            color: var(--md-on-primary-container);
            border-color: var(--md-primary);
        }
        .mode-btn:active { transform: scale(0.95); }

        /* Slider */
        .slider-container {
            width: 100%;
            margin: 16px 0 10px;
        }
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            color: var(--md-outline);
            font-size: 14px;
            text-transform: capitalize;
        }
        .slider-value {
            font-weight: 600;
            color: var(--md-primary);
            font-size: 16px;
        }
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 5px;
            background: var(--md-surface-container-high);
            border-radius: 8px;
            outline: none;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: var(--md-primary);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px var(--md-shadow);
            border: 2px solid var(--md-on-primary-container);
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 16px;
        }
        .btn-apply, .btn-reset {
            flex: 1;
            padding: 12px 10px;
            border: none;
            border-radius: 100px;
            font-size: 13px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            cursor: pointer;
            transition: opacity 0.15s, transform 0.1s, box-shadow 0.15s;
            min-width: 0;
            box-shadow: 0 2px 6px var(--md-shadow);
            text-transform: capitalize;
        }
        .btn-apply {
            background-color: var(--md-primary-container);
            color: var(--md-on-primary-container);
        }
        .btn-reset {
            background-color: var(--md-secondary-container);
            color: var(--md-on-secondary-container);
        }
        .btn-apply:active, .btn-reset:active {
            transform: scale(0.98);
            opacity: 0.9;
        }

        /* Banner Selector dengan preview gambar lanskap - TANPA TEKS */
        .banner-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 16px 0;
        }
        .banner-option {
            background-color: transparent;
            border-radius: 18px;
            padding: 0;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.15s var(--anim-curve);
            box-shadow: none;
            position: relative;
            overflow: hidden;
        }
        .banner-option.active {
            border-color: var(--md-primary);
            transform: scale(0.98);
        }
        
        .banner-preview {
            width: 100%;
            height: 100px;
            border-radius: 12px;
            background-size: cover;
            background-position: center;
            border: 1px solid var(--md-outline);
            transition: all 0.2s ease;
            aspect-ratio: 16/9;
        }
        
        .banner-option.active .banner-preview {
            border: 2px solid var(--md-primary);
            box-shadow: 0 0 0 2px var(--md-primary-container);
        }

        .theme-section {
            margin-bottom: 24px;
            background: var(--md-surface-glass);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 16px;
            border: 1px solid var(--md-outline);
        }
        .theme-title {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 600;
            text-transform: capitalize;
        }

        /* Navigation dengan animasi pop */
        .nav-container {
            position: fixed; 
            bottom: calc(14px + var(--window-inset-bottom, 0px));
            left: 14px;
            right: 14px;
            height: 64px;
            background-color: var(--md-surface-container-high); 
            border-radius: 100px;
            box-shadow: 0 4px 20px var(--md-shadow);
            display: flex; 
            justify-content: space-evenly; 
            align-items: center;
            z-index: 100; 
            transition: background-color 0.2s ease, transform 0.2s;
            border: 1px solid var(--md-outline);
        }
        .nav-container.hidden { 
            transform: translateY(150px); 
        }
        .nav-item { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            width: 75px; 
            cursor: pointer; 
            gap: 2px; 
        }
        .nav-pill { 
            width: 58px; 
            height: 30px; 
            border-radius: 15px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            transition: background-color 0.15s ease; 
        }
        .nav-item .material-symbols-rounded { 
            color: var(--md-outline); 
            transition: 0.15s; 
            font-size: 23px;
        }
        .nav-label { 
            font-size: 10px; 
            font-weight: 500; 
            color: var(--md-outline); 
            transition: 0.15s; 
            text-transform: capitalize;
        }
        
        .nav-item.active .material-symbols-rounded { 
            color: var(--md-on-secondary-container); 
            font-variation-settings: 'FILL' 1; 
            animation: pop 0.3s var(--pop-curve); 
        }
        .nav-item.active .nav-pill { 
            background-color: var(--md-secondary-container); 
        }
        .nav-item.active .nav-label { 
            color: var(--md-on-bg); 
            font-weight: 600; 
        }
        
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1.1); }
        }

        /* Rotate Icon */
        .rotate-icon {
            transition: transform 0.3s ease;
        }
        .rotate-icon.rotated {
            transform: rotate(360deg);
        }

        /* Spin Animation */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .rotating {
            animation: spin 1s linear infinite;
        }

        /* Sub Pages */
        .sub-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--md-bg);
            z-index: 1100;
            transform: translateY(-100%);
            transition: transform 0.25s var(--anim-curve);
            display: flex;
            flex-direction: column;
            padding-top: var(--window-inset-top, 0px);
            overflow-y: auto;
            will-change: transform;
            -webkit-overflow-scrolling: touch;
        }
        .sub-page.open {
            transform: translateY(0);
        }
        .sub-header {
            padding: 12px 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            position: sticky;
            top: 0;
            background-color: var(--md-bg);
            z-index: 1101;
            border-bottom: 1px solid var(--md-surface-container-high);
            transition: background-color 0.2s ease;
        }
        .back-btn {
            background: none;
            border: none;
            color: var(--md-on-bg);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background-color: var(--md-surface-container);
            transition: background-color 0.15s ease;
        }
        .back-btn:active {
            background-color: var(--md-surface-container-high);
        }
        .sub-header span {
            font-size: 20px;
            font-weight: 500;
            text-transform: capitalize;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.15s ease;
        }
        .modal-overlay.show {
            opacity: 1;
            pointer-events: auto;
        }
        .modal-content {
            background-color: var(--md-surface-container);
            border-radius: 24px;
            padding: 20px;
            width: 85%;
            max-width: 380px;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.15s var(--anim-curve);
            box-shadow: 0 8px 30px var(--md-shadow);
        }
        .modal-overlay.show .modal-content {
            transform: scale(1);
        }
        .modal-icon {
            font-size: 48px;
            color: var(--md-error);
            margin-bottom: 12px;
        }
        .modal-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: capitalize;
        }
        .modal-text {
            color: var(--md-outline);
            font-size: 13px;
            margin-bottom: 16px;
            text-transform: capitalize;
        }
        .modal-resolution {
            background-color: var(--md-surface-container-high);
            padding: 12px;
            border-radius: 16px;
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 500;
        }
        .modal-timer {
            font-size: 28px;
            font-weight: 700;
            color: var(--md-primary);
            margin-bottom: 16px;
        }
        .modal-buttons {
            display: flex;
            gap: 12px;
        }
        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 100px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.15s, transform 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            text-transform: capitalize;
        }
        .modal-btn:active {
            transform: scale(0.95);
        }
        .modal-btn-danger {
            background-color: var(--md-error);
            color: white;
        }
        .modal-btn-success {
            background-color: var(--md-success);
            color: black;
        }
        .modal-btn:disabled {
            opacity: 0.5;
            pointer-events: none;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 75px;
            left: 16px;
            right: 16px;
            background-color: var(--md-surface-container-high);
            color: var(--md-on-bg);
            padding: 14px;
            border-radius: 100px;
            text-align: center;
            font-weight: 500;
            font-size: 13px;
            z-index: 9999;
            display: none;
            box-shadow: 0 4px 12px var(--md-shadow);
            animation: slideUp 0.15s ease;
            text-transform: capitalize;
        }
        @keyframes slideUp {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* Optimasi performa */
        .will-change-transform {
            will-change: transform;
        }
        
        .will-change-opacity {
            will-change: opacity;
        }
        
        /* Hardware acceleration */
        .gpu-accelerated {
            transform: translateZ(0);
            backface-visibility: hidden;
            perspective: 1000px;
        }
    </style>
</head>
<body class="gpu-accelerated">
    <!-- Banner URLs dengan preview - HANYA URL GAMBAR -->
    <script>
        const BANNER_DARK_OPTIONS = [
            { url: 'https://i.ibb.co.com/dsTq9B3h/png.jpg', preview: 'https://i.ibb.co.com/dsTq9B3h/png.jpg' },
            { url: 'https://i.ibb.co.com/Dgpm7cVZ/aee742d12f0b4b91f1147eedb8c72fcc.jpg', preview: 'https://i.ibb.co.com/Dgpm7cVZ/aee742d12f0b4b91f1147eedb8c72fcc.jpg' },
            { url: 'https://i.ibb.co.com/Tqn8htfP/5eacfa118970dfb7cccb56b31dff8eba.jpg', preview: 'https://i.ibb.co.com/Tqn8htfP/5eacfa118970dfb7cccb56b31dff8eba.jpg' }
        ];
        
        const BANNER_LIGHT_OPTIONS = [
            { url: 'https://i.ibb.co.com/wFDWXR8h/b2db0ab2aa7f49c9810727ffe7a919d8.jpg', preview: 'https://i.ibb.co.com/wFDWXR8h/b2db0ab2aa7f49c9810727ffe7a919d8.jpg' },
            { url: 'https://i.ibb.co.com/LDzm5Yrq/ebddb34d1765a098cc316bd5c89356ee.jpg', preview: 'https://i.ibb.co.com/LDzm5Yrq/ebddb34d1765a098cc316bd5c89356ee.jpg' },
            { url: 'https://i.ibb.co.com/DD1DfjJQ/128bf14ecbf4ea63ec5c5665006afd7e.jpg', preview: 'https://i.ibb.co.com/DD1DfjJQ/128bf14ecbf4ea63ec5c5665006afd7e.jpg' }
        ];
        
        // Load saved preferences
        let selectedDarkBanner = parseInt(localStorage.getItem('astraxDarkBanner')) || 0;
        let selectedLightBanner = parseInt(localStorage.getItem('astraxLightBanner')) || 0;
        let currentTheme = localStorage.getItem('astraxTheme') || 'dark';
        let savedBatteryMode = localStorage.getItem('astraxBatteryMode') || 'optimized';
        let savedProfileMode = localStorage.getItem('astraxSelectedMode') || 'balance';
        
        if (currentTheme === 'light') {
            document.documentElement.style.setProperty('--banner-url', `url('${BANNER_LIGHT_OPTIONS[selectedLightBanner].url}')`);
        } else {
            document.documentElement.style.setProperty('--banner-url', `url('${BANNER_DARK_OPTIONS[selectedDarkBanner].url}')`);
        }
    </script>

    <!-- Splash Screen -->
    <div class="splash-screen" id="splash">
        <div class="splash-content">
            <span class="material-symbols-rounded">auto_awesome</span>
            <h1>Welcome To Astrax</h1>
        </div>
    </div>

    <!-- Dashboard Panel -->
    <div class="dashboard-panel" id="dashboardPanel">
        <div class="dashboard-header">
            <h2>Dashboard</h2>
        </div>
        <div class="dashboard-grid">
            <div class="dashboard-item">
                <span class="material-symbols-rounded" id="dashboardRamIcon">memory</span>
                <div class="value" id="dashboardRam">0 Gb</div>
                <div class="label">Ram</div>
            </div>
            <div class="dashboard-item">
                <span class="material-symbols-rounded">developer_board</span>
                <div class="value" id="dashboardCpu">0%</div>
                <div class="label">Cpu</div>
            </div>
            <div class="dashboard-item">
                <span class="material-symbols-rounded icon-sleep" id="dashboardBatteryIcon">bedtime</span>
                <div class="value" id="dashboardBattery">0%</div>
                <div class="label">Battery</div>
            </div>
            <div class="dashboard-item">
                <span class="material-symbols-rounded">storage</span>
                <div class="value" id="dashboardStorage">0 Gb</div>
                <div class="label">Storage</div>
            </div>
            <div class="dashboard-item">
                <span class="material-symbols-rounded" id="dashboardBatteryModeIcon">battery_charging_full</span>
                <div class="value" id="dashboardBatteryMode">Optimized</div>
                <div class="label">Battery Usage</div>
            </div>
            <div class="dashboard-item">
                <span class="material-symbols-rounded" id="dashboardProfileIcon">speed</span>
                <div class="value" id="dashboardProfile">Balance</div>
                <div class="label">Profile</div>
            </div>
        </div>
    </div>

    <header class="top-app-bar" id="mainHeader">
        <div class="header-branding">
            <span class="material-symbols-rounded app-logo">auto_awesome</span>
            <div class="app-title">Astrax</div>
            <span class="beta-tag">Beta</span>
        </div>
        <div class="header-actions">
            <button class="dashboard-btn" id="dashboardBtn" onclick="toggleDashboard()">
                <span class="material-symbols-rounded">expand_more</span>
            </button>
            <button class="theme-toggle-btn" id="themeToggleBtn" onclick="toggleTheme(event)">
                <span class="material-symbols-rounded" id="themeIcon">dark_mode</span>
            </button>
        </div>
    </header>

    <main class="main-content" id="mainContent">
        <!-- Tab Container untuk Swipe -->
        <div class="tab-container">
            <div class="tabs-wrapper" id="tabsWrapper">
                <!-- Home Section (index 0) -->
                <section id="home" class="tab-section">
                    <div class="banner-hero" id="mainBanner">
                        <button class="custom-banner-btn-banner" onclick="openCustomBannerPage()">
                            <span class="material-symbols-rounded">wallpaper</span>
                        </button>
                    </div>
                    
                    <div class="device-info-card">
                        <div class="device-info-header">
                            <div class="device-info-icon">
                                <span class="material-symbols-rounded">info</span>
                            </div>
                            <div class="device-info-title">Device Information</div>
                        </div>
                        <div class="device-info-grid">
                            <div class="device-info-item">
                                <div class="device-info-label">Model</div>
                                <div class="device-info-value" id="deviceModel">Loading...</div>
                            </div>
                            <div class="device-info-item">
                                <div class="device-info-label">Platform</div>
                                <div class="device-info-value" id="chipsetInfo">Loading...</div>
                            </div>
                            <div class="device-info-item">
                                <div class="device-info-label">Ram</div>
                                <div class="device-info-value" id="ramInfo">Loading...</div>
                            </div>
                            <div class="device-info-item">
                                <div class="device-info-label">Kernel</div>
                                <div class="device-info-value" id="kernelInfo">Loading...</div>
                            </div>
                            <div class="device-info-item">
                                <div class="device-info-label">Android</div>
                                <div class="device-info-value" id="androidVer">Loading...</div>
                            </div>
                            <div class="device-info-item">
                                <div class="device-info-label">Api Level</div>
                                <div class="device-info-value" id="apiLevel">Loading...</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Settings Section (index 1) -->
                <section id="settings" class="tab-section">
                    <!-- Screen Adjustment Section -->
                    <div class="section-header">Screen Adjustment</div>
                    
                    <!-- Resolution Changer -->
                    <div class="card clickable-item" onclick="openResPage()">
                        <div class="settings-item">
                            <div class="settings-left">
                                <span class="material-symbols-rounded settings-icon">aspect_ratio</span>
                                <div class="settings-text">
                                    <h3>Resolution Changer</h3>
                                    <p>Ubah Resolusi Layar</p>
                                </div>
                            </div>
                            <span class="material-symbols-rounded" style="color: var(--md-outline); font-size: 18px;">arrow_forward_ios</span>
                        </div>
                    </div>

                    <!-- Pointer Sensitivity -->
                    <div class="card clickable-item" onclick="openSensitivityPage()">
                        <div class="settings-item">
                            <div class="settings-left">
                                <span class="material-symbols-rounded settings-icon">touch_app</span>
                                <div class="settings-text">
                                    <h3>Pointer Sensitivity</h3>
                                    <p>Atur Kecepatan Pointer</p>
                                </div>
                            </div>
                            <span class="material-symbols-rounded" style="color: var(--md-outline); font-size: 18px;">arrow_forward_ios</span>
                        </div>
                    </div>

                    <!-- Battery Management Section -->
                    <div class="section-header">Battery Management</div>

                    <!-- Profile -->
                    <div class="card clickable-item" onclick="openModePage()">
                        <div class="settings-item">
                            <div class="settings-left">
                                <span class="material-symbols-rounded settings-icon rotate-icon" id="modeIcon">speed</span>
                                <div class="settings-text">
                                    <h3>Profile</h3>
                                    <p>Atur Profil Kinerja</p>
                                </div>
                            </div>
                            <span class="material-symbols-rounded" style="color: var(--md-outline); font-size: 18px;">arrow_forward_ios</span>
                        </div>
                    </div>

                    <!-- Battery Usage -->
                    <div class="card clickable-item" onclick="openBatteryPage()">
                        <div class="settings-item">
                            <div class="settings-left">
                                <span class="material-symbols-rounded settings-icon">battery_saver</span>
                                <div class="settings-text">
                                    <h3>Battery Usage</h3>
                                    <p>Optimasi Penggunaan Baterai</p>
                                </div>
                            </div>
                            <span class="material-symbols-rounded" style="color: var(--md-outline); font-size: 18px;">arrow_forward_ios</span>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <!-- Custom Banner Page dengan preview gambar lanskap - TANPA TEKS DESKRIPSI -->
    <div id="customBannerPage" class="sub-page">
        <div class="sub-header">
            <button class="back-btn" onclick="closeCustomBannerPage()"><span class="material-symbols-rounded">arrow_back</span></button>
            <span>Custom Banner</span>
        </div>
        <div class="main-content" style="padding-top: 8px;">
            <div class="theme-section">
                <div class="theme-title">
                    <span class="material-symbols-rounded">dark_mode</span>
                    <span>Dark Mode Banners</span>
                </div>
                <div class="banner-options">
                    <div class="banner-option" id="darkBanner0" onclick="selectDarkBanner(0)">
                        <div class="banner-preview" style="background-image: url('https://i.ibb.co.com/dsTq9B3h/png.jpg');"></div>
                    </div>
                    <div class="banner-option" id="darkBanner1" onclick="selectDarkBanner(1)">
                        <div class="banner-preview" style="background-image: url('https://i.ibb.co.com/Dgpm7cVZ/aee742d12f0b4b91f1147eedb8c72fcc.jpg');"></div>
                    </div>
                    <div class="banner-option" id="darkBanner2" onclick="selectDarkBanner(2)">
                        <div class="banner-preview" style="background-image: url('https://i.ibb.co.com/Tqn8htfP/5eacfa118970dfb7cccb56b31dff8eba.jpg');"></div>
                    </div>
                </div>
            </div>

            <div class="theme-section">
                <div class="theme-title">
                    <span class="material-symbols-rounded">light_mode</span>
                    <span>Light Mode Banners</span>
                </div>
                <div class="banner-options">
                    <div class="banner-option" id="lightBanner0" onclick="selectLightBanner(0)">
                        <div class="banner-preview" style="background-image: url('https://i.ibb.co.com/wFDWXR8h/b2db0ab2aa7f49c9810727ffe7a919d8.jpg');"></div>
                    </div>
                    <div class="banner-option" id="lightBanner1" onclick="selectLightBanner(1)">
                        <div class="banner-preview" style="background-image: url('https://i.ibb.co.com/LDzm5Yrq/ebddb34d1765a098cc316bd5c89356ee.jpg');"></div>
                    </div>
                    <div class="banner-option" id="lightBanner2" onclick="selectLightBanner(2)">
                        <div class="banner-preview" style="background-image: url('https://i.ibb.co.com/DD1DfjJQ/128bf14ecbf4ea63ec5c5665006afd7e.jpg');"></div>
                    </div>
                </div>
            </div>

            <div class="btn-group" style="margin-top: 16px;">
                <button class="btn-reset" onclick="resetBanners()">
                    <span class="material-symbols-rounded">restart_alt</span> Reset Default
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Konfirmasi Apply Resolution -->
    <div class="modal-overlay" id="applyResolutionModal">
        <div class="modal-content">
            <span class="material-symbols-rounded modal-icon">warning</span>
            <div class="modal-title">Konfirmasi?</div>
            <div class="modal-text">Anda Akan Mengubah Resolusi Ke:</div>
            <div class="modal-resolution" id="applyModalResolutionText">1920x1080</div>
            <div class="modal-timer" id="applyTimer">10</div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-danger" id="applyNoBtn" onclick="cancelApplyResolution()">
                    <span class="material-symbols-rounded">close</span> Tidak
                </button>
                <button class="modal-btn modal-btn-success" id="applyYesBtn" onclick="confirmApplyResolution()" disabled>
                    <span class="material-symbols-rounded">check</span> Ya
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Konfirmasi Reset Resolution -->
    <div class="modal-overlay" id="resetResolutionModal">
        <div class="modal-content">
            <span class="material-symbols-rounded modal-icon">warning</span>
            <div class="modal-title">Reset Resolusi?</div>
            <div class="modal-text">Ini Akan Mereset Ke Resolusi Default Perangkat</div>
            <div class="modal-timer" id="resetTimer">10</div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-danger" id="resetNoBtn" onclick="cancelResetResolution()">
                    <span class="material-symbols-rounded">close</span> Tidak
                </button>
                <button class="modal-btn modal-btn-success" id="resetYesBtn" onclick="confirmResetResolution()" disabled>
                    <span class="material-symbols-rounded">check</span> Ya
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Konfirmasi Battery Mode -->
    <div class="modal-overlay" id="applyBatteryModal">
        <div class="modal-content">
            <span class="material-symbols-rounded modal-icon">help</span>
            <div class="modal-title">Konfirmasi Mode Baterai</div>
            <div class="modal-text" id="batteryConfirmText">Are You Sure You Want To Continue?</div>
            <div id="batteryLoadingSpinner" style="display: none; justify-content: center; margin: 16px 0;">
                <span class="material-symbols-rounded rotating" style="font-size: 32px; color: var(--md-primary);">progress_activity</span>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-danger" id="batteryNoBtn" onclick="cancelApplyBattery()">
                    <span class="material-symbols-rounded">close</span> Cancel
                </button>
                <button class="modal-btn modal-btn-success" id="batteryYesBtn" onclick="confirmApplyBattery()">
                    <span class="material-symbols-rounded">check</span> Yes
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Konfirmasi Profile Mode -->
    <div class="modal-overlay" id="applyProfileModal">
        <div class="modal-content">
            <span class="material-symbols-rounded modal-icon">help</span>
            <div class="modal-title">Konfirmasi Profile</div>
            <div class="modal-text" id="profileConfirmText">Menerapkan Mode Profile...</div>
            <div id="profileLoadingSpinner" style="display: none; justify-content: center; margin: 16px 0;">
                <span class="material-symbols-rounded rotating" style="font-size: 32px; color: var(--md-primary);">progress_activity</span>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-danger" id="profileNoBtn" onclick="cancelApplyProfile()">
                    <span class="material-symbols-rounded">close</span> Cancel
                </button>
                <button class="modal-btn modal-btn-success" id="profileYesBtn" onclick="confirmApplyProfile()">
                    <span class="material-symbols-rounded">check</span> Yes
                </button>
            </div>
        </div>
    </div>

    <!-- Resolution Changer Page -->
    <div id="resPage" class="sub-page">
        <div class="sub-header">
            <button class="back-btn" onclick="closeResPage()"><span class="material-symbols-rounded">arrow_back</span></button>
            <span>Resolution Changer</span>
        </div>
        <div class="main-content" style="padding-top: 8px;">
            <div class="feature-card">
                <div class="feature-header">
                    <div class="feature-icon-large">
                        <span class="material-symbols-rounded">aspect_ratio</span>
                    </div>
                    <div>
                        <div class="feature-title-large">Resolution Changer</div>
                        <div class="feature-desc-large">Ubah Resolusi Layar</div>
                    </div>
                </div>
                
                <div class="feature-description-box">
                    <span class="material-symbols-rounded">info</span> <strong>Fungsi:</strong> Mengubah Resolusi Layar Untuk Meningkatkan Performa Gaming Atau Menghemat Baterai
                </div>

                <div class="expand-card">
                    <div class="expand-header" onclick="toggleResSection()">
                        <div class="expand-left">
                            <span class="material-symbols-rounded feature-icon">settings</span>
                            <div>
                                <div style="font-weight: 500;">Custom Resolution</div>
                                <div style="font-size: 12px; color: var(--md-outline);">Atur Lebar Dan Tinggi</div>
                            </div>
                        </div>
                        <span class="material-symbols-rounded expand-icon" id="resExpandIcon">expand_more</span>
                    </div>
                    <div id="resContainer" class="expand-content">
                        <div class="md-input-group">
                            <input type="number" id="resW" class="md-input" placeholder="Lebar (Px)" min="600" max="3800">
                        </div>
                        <div class="md-input-group">
                            <input type="number" id="resH" class="md-input" placeholder="Tinggi (Px)" min="600" max="3800">
                        </div>
                        <div class="btn-group">
                            <button class="btn-apply" onclick="showApplyResolutionConfirm()">
                                <span class="material-symbols-rounded">check_circle</span> Terapkan
                            </button>
                            <button class="btn-reset" onclick="showResetResolutionConfirm()">
                                <span class="material-symbols-rounded">restart_alt</span> Reset
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Page -->
    <div id="modePage" class="sub-page">
        <div class="sub-header">
            <button class="back-btn" onclick="closeModePage()"><span class="material-symbols-rounded">arrow_back</span></button>
            <span>Profile</span>
        </div>
        <div class="main-content" style="padding-top: 8px;">
            <div class="feature-card">
                <div class="feature-header">
                    <div class="feature-icon-large">
                        <span class="material-symbols-rounded">speed</span>
                    </div>
                    <div>
                        <div class="feature-title-large">Profile</div>
                        <div class="feature-desc-large">Optimasi Kinerja</div>
                    </div>
                </div>
                
                <div class="feature-description-box">
                    <span class="material-symbols-rounded">info</span> <strong>Fungsi:</strong> Mengatur Profil Kinerja Perangkat<br>
                    Battery (Hemat Daya), Balance (Seimbang), Performance (Maksimal)
                </div>

                <div class="expand-card">
                    <div class="expand-header" onclick="toggleModeSection()">
                        <div class="expand-left">
                            <span class="material-symbols-rounded feature-icon">tune</span>
                            <div>
                                <div style="font-weight: 500;">Mode Selector</div>
                                <div style="font-size: 12px; color: var(--md-outline);">Pilih Profil Kinerja</div>
                            </div>
                        </div>
                        <span class="material-symbols-rounded expand-icon" id="modeExpandIcon">expand_more</span>
                    </div>
                    <div id="modeContainer" class="expand-content">
                        <div class="mode-selector">
                            <button class="mode-btn" id="modeBattery" onclick="setSelectedMode('battery')">Battery</button>
                            <button class="mode-btn" id="modeBalance" onclick="setSelectedMode('balance')">Balance</button>
                            <button class="mode-btn" id="modePerformance" onclick="setSelectedMode('performance')">Performance</button>
                        </div>
                        <div class="btn-group">
                            <button class="btn-apply" onclick="showApplyProfileConfirm()">
                                <span class="material-symbols-rounded">check_circle</span> Terapkan
                            </button>
                            <button class="btn-reset" onclick="resetMode()">
                                <span class="material-symbols-rounded">restart_alt</span> Reset
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sensitivity Page -->
    <div id="sensitivityPage" class="sub-page">
        <div class="sub-header">
            <button class="back-btn" onclick="closeSensitivityPage()"><span class="material-symbols-rounded">arrow_back</span></button>
            <span>Pointer Sensitivity</span>
        </div>
        <div class="main-content" style="padding-top: 8px;">
            <div class="feature-card">
                <div class="feature-header">
                    <div class="feature-icon-large">
                        <span class="material-symbols-rounded">touch_app</span>
                    </div>
                    <div>
                        <div class="feature-title-large">Pointer Sensitivity</div>
                        <div class="feature-desc-large">Atur Kecepatan Pointer</div>
                    </div>
                </div>
                
                <div class="feature-description-box">
                    <span class="material-symbols-rounded">info</span> <strong>Fungsi:</strong> Mengatur Kecepatan Pointer/Kursor. Nilai 1 (Lambat) Hingga 7 (Cepat), Default 4
                </div>

                <div class="expand-card">
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Kecepatan</span>
                            <span class="slider-value" id="sensitivityValue">4</span>
                        </div>
                        <input type="range" id="sensitivitySlider" min="1" max="7" value="4" step="1" oninput="updateSensitivityValue(this.value)">
                    </div>

                    <div class="btn-group">
                        <button class="btn-apply" onclick="applySensitivity()">
                            <span class="material-symbols-rounded">check_circle</span> Terapkan
                        </button>
                        <button class="btn-reset" onclick="resetSensitivity()">
                            <span class="material-symbols-rounded">restart_alt</span> Reset
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Battery Usage Page -->
    <div id="batteryPage" class="sub-page">
        <div class="sub-header">
            <button class="back-btn" onclick="closeBatteryPage()"><span class="material-symbols-rounded">arrow_back</span></button>
            <span>Battery Usage</span>
        </div>
        <div class="main-content" style="padding-top: 8px; overflow-y: auto;">
            <div class="feature-card">
                <div class="feature-header">
                    <div class="feature-icon-large">
                        <span class="material-symbols-rounded">battery_saver</span>
                    </div>
                    <div>
                        <div class="feature-title-large">Battery Usage</div>
                        <div class="feature-desc-large">Optimasi Penggunaan Baterai</div>
                    </div>
                </div>
                
                <div class="feature-description-box">
                    <span class="material-symbols-rounded">info</span> <strong>Fungsi:</strong> Pilih Mode Penggunaan Baterai Yang Sesuai Dengan Kebutuhan Anda Untuk Menyeimbangkan Antara Performa Dan Daya Tahan Baterai
                </div>

                <div class="expand-card">
                    <div class="expand-header" onclick="toggleBatterySection()">
                        <div class="expand-left">
                            <span class="material-symbols-rounded feature-icon">battery_charging_full</span>
                            <div>
                                <div style="font-weight: 500;">Mode Selector</div>
                                <div style="font-size: 12px; color: var(--md-outline);">Pilih Profil Baterai</div>
                            </div>
                        </div>
                        <span class="material-symbols-rounded expand-icon" id="batteryExpandIcon">expand_more</span>
                    </div>
                    <div id="batteryContainer" class="expand-content">
                        <!-- Restricted Mode -->
                        <div class="card" style="margin-bottom: 8px; padding: 12px; cursor: pointer;" onclick="setSelectedBatteryMode('restricted')">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span class="material-symbols-rounded" style="font-size: 32px; color: var(--md-error);">battery_alert</span>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; font-size: 16px;">Restricted <span style="font-size: 12px; color: var(--md-outline);">(Save Battery)</span></div>
                                    <div style="font-size: 12px; color: var(--md-outline);">Batasi Aktivitas Latar Belakang Untuk Menghemat Daya Maksimal</div>
                                </div>
                                <span class="material-symbols-rounded" id="batteryModeRestrictedIcon" style="color: transparent;">radio_button_unchecked</span>
                            </div>
                        </div>
                        <!-- Optimized Mode -->
                        <div class="card" style="margin-bottom: 8px; padding: 12px; cursor: pointer;" onclick="setSelectedBatteryMode('optimized')">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span class="material-symbols-rounded" style="font-size: 32px; color: var(--md-success);">battery_charging_full</span>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; font-size: 16px;">Optimized <span style="font-size: 12px; color: var(--md-outline);">(Default)</span></div>
                                    <div style="font-size: 12px; color: var(--md-outline);">Keseimbangan Sempurna Antara Kinerja Dan Penghematan Daya</div>
                                </div>
                                <span class="material-symbols-rounded" id="batteryModeOptimizedIcon" style="color: transparent;">radio_button_unchecked</span>
                            </div>
                        </div>
                        <!-- Unrestricted Mode -->
                        <div class="card" style="margin-bottom: 8px; padding: 12px; cursor: pointer;" onclick="setSelectedBatteryMode('unrestricted')">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span class="material-symbols-rounded" style="font-size: 32px; color: var(--md-primary);">battery_full</span>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; font-size: 16px;">Unrestricted <span style="font-size: 12px; color: var(--md-outline);">(Performance)</span></div>
                                    <div style="font-size: 12px; color: var(--md-outline);">Kinerja Maksimal Tanpa Batasan Latar Belakang</div>
                                </div>
                                <span class="material-symbols-rounded" id="batteryModeUnrestrictedIcon" style="color: transparent;">radio_button_unchecked</span>
                            </div>
                        </div>
                        <div class="btn-group" style="margin-top: 24px;">
                            <button class="btn-apply" id="applyBatteryBtn" onclick="showApplyBatteryConfirm()" disabled>
                                <span class="material-symbols-rounded">check_circle</span> Apply
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Navigation - Hanya 2 tab (Home dan Settings) -->
    <nav class="nav-container" id="mainNav">
        <div class="nav-item active" id="nav-home" onclick="switchTab(0)">
            <div class="nav-pill"><span class="material-symbols-rounded">home</span></div>
            <span class="nav-label">Home</span>
        </div>
        <div class="nav-item" id="nav-settings" onclick="switchTab(1)">
            <div class="nav-pill"><span class="material-symbols-rounded">settings</span></div>
            <span class="nav-label">Settings</span>
        </div>
    </nav>

    <script>
        // Optimasi performa: throttle function
        function throttle(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            };
        }

        // Debounce function untuk optimasi
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Log system untuk menyimpan semua pengaturan
        const SettingsLog = {
            saveBanner: function(theme, index) {
                const log = this.getLog();
                log.banner[theme] = index;
                localStorage.setItem('astraxSettingsLog', JSON.stringify(log));
            },
            
            saveProfile: function(mode) {
                const log = this.getLog();
                log.profile = mode;
                localStorage.setItem('astraxSettingsLog', JSON.stringify(log));
                localStorage.setItem('astraxSelectedMode', mode);
            },
            
            saveBatteryMode: function(mode) {
                const log = this.getLog();
                log.batteryMode = mode;
                localStorage.setItem('astraxSettingsLog', JSON.stringify(log));
                localStorage.setItem('astraxBatteryMode', mode);
            },
            
            saveSensitivity: function(value) {
                const log = this.getLog();
                log.sensitivity = value;
                localStorage.setItem('astraxSettingsLog', JSON.stringify(log));
            },
            
            saveResolution: function(width, height) {
                const log = this.getLog();
                log.resolution = { width, height };
                localStorage.setItem('astraxSettingsLog', JSON.stringify(log));
            },
            
            getLog: function() {
                const defaultLog = {
                    banner: { dark: 0, light: 0 },
                    profile: 'balance',
                    batteryMode: 'optimized',
                    sensitivity: 4,
                    resolution: { width: 1080, height: 2400 }
                };
                
                const saved = localStorage.getItem('astraxSettingsLog');
                return saved ? { ...defaultLog, ...JSON.parse(saved) } : defaultLog;
            },
            
            loadAllSettings: function() {
                const log = this.getLog();
                
                // Load banner
                selectedDarkBanner = log.banner.dark || 0;
                selectedLightBanner = log.banner.light || 0;
                
                // Load profile
                selectedProfileMode = log.profile || 'balance';
                
                // Load battery mode
                selectedBatteryMode = log.batteryMode || 'optimized';
                
                // Load sensitivity
                const savedSensitivity = log.sensitivity || 4;
                
                // Apply to UI after DOM is ready
                setTimeout(() => {
                    // Update banner UI
                    updateBannerSelectionUI();
                    
                    // Update profile UI
                    setSelectedMode(selectedProfileMode);
                    
                    // Update battery UI
                    setSelectedBatteryMode(selectedBatteryMode);
                    
                    // Update sensitivity if slider exists
                    const sensitivitySlider = document.getElementById('sensitivitySlider');
                    if (sensitivitySlider) {
                        sensitivitySlider.value = savedSensitivity;
                        document.getElementById('sensitivityValue').innerText = savedSensitivity;
                    }
                    
                    // Update dashboard
                    updateDashboardStats();
                }, 100);
            }
        };

        // Splash Screen
        setTimeout(() => {
            const splash = document.getElementById('splash');
            splash.classList.add('hide');
            setTimeout(() => {
                if (splash && splash.parentNode) {
                    splash.style.display = 'none';
                }
            }, 300);
        }, 1000);

        window.ksu = window.ksu || { 
            exec: async (cmd) => {
                console.log('Exec (mock):', cmd);
                return { stdout: '' };
            }
        };
        
        async function execShell(cmd) {
            try {
                if (window.ksu && window.ksu.exec) {
                    const res = await window.ksu.exec(cmd);
                    return res.stdout || res || '';
                }
                console.log('Exec (mock):', cmd);
                return '';
            } catch (e) { 
                console.error(e); 
                return ''; 
            }
        }

        function showToast(message, isSuccess = true) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.backgroundColor = isSuccess ? 'var(--md-success)' : 'var(--md-error)';
            toast.style.color = '#000';
            toast.style.display = 'block';
            setTimeout(() => {
                toast.style.display = 'none';
                toast.style.backgroundColor = 'var(--md-surface-container-high)';
                toast.style.color = 'var(--md-on-bg)';
            }, 2000);
        }

        // Timer variables
        let applyTimerInterval = null;
        let resetTimerInterval = null;
        let applyTimerValue = 10;
        let resetTimerValue = 10;
        let batteryApplyTimerInterval = null;
        let profileApplyTimerInterval = null;

        // Global variables
        let androidVersion = 0;
        let dashboardUpdateInterval = null;
        let currentTabIndex = 0;
        let isThemeChanging = false; // Untuk anti-spam dengan waktu 1 detik

        // Battery Mode Variables
        let selectedBatteryMode = 'optimized';
        let selectedProfileMode = 'balance';

        // Touch handling untuk swipe
        let touchStartX = 0;
        let touchStartY = 0;
        let isSwiping = false;
        const tabsWrapper = document.getElementById('tabsWrapper');
        
        tabsWrapper.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
            isSwiping = true;
        }, { passive: true });
        
        tabsWrapper.addEventListener('touchmove', (e) => {
            if (!isSwiping) return;
            
            const diffX = Math.abs(e.changedTouches[0].screenX - touchStartX);
            const diffY = Math.abs(e.changedTouches[0].screenY - touchStartY);
            
            if (diffX > diffY && diffX > 10) {
                e.preventDefault();
            }
        }, { passive: false });
        
        tabsWrapper.addEventListener('touchend', (e) => {
            if (!isSwiping) return;
            
            const diffX = e.changedTouches[0].screenX - touchStartX;
            const diffY = e.changedTouches[0].screenY - touchStartY;
            
            const swipeThreshold = 40;
            if (Math.abs(diffX) > swipeThreshold && Math.abs(diffX) > Math.abs(diffY)) {
                if (diffX < 0 && currentTabIndex < 1) {
                    switchTab(currentTabIndex + 1);
                } else if (diffX > 0 && currentTabIndex > 0) {
                    switchTab(currentTabIndex - 1);
                }
            }
            
            isSwiping = false;
        }, { passive: true });
        
        function switchTab(index) {
            if (index < 0 || index > 1) return;
            
            currentTabIndex = index;
            
            tabsWrapper.style.transform = `translateX(-${index * 100}%)`;
            
            document.querySelectorAll('.nav-item').forEach((item, i) => {
                if (i === index) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            if (index === 0) updateHomeData();
        }

        // Dashboard
        let isDashboardOpen = false;

        function toggleDashboard() {
            const panel = document.getElementById('dashboardPanel');
            const btn = document.getElementById('dashboardBtn');
            const mainContent = document.getElementById('mainContent');
            
            if (isDashboardOpen) {
                panel.classList.remove('open');
                btn.classList.remove('active');
                mainContent.classList.remove('dashboard-open');
                if (dashboardUpdateInterval) {
                    clearInterval(dashboardUpdateInterval);
                    dashboardUpdateInterval = null;
                }
            } else {
                panel.classList.add('open');
                btn.classList.add('active');
                mainContent.classList.add('dashboard-open');
                updateDashboardStats();
                if (dashboardUpdateInterval) clearInterval(dashboardUpdateInterval);
                dashboardUpdateInterval = setInterval(updateDashboardStats, 3000);
            }
            
            isDashboardOpen = !isDashboardOpen;
        }

        async function updateDashboardStats() {
            try {
                const memInfo = await execShell("cat /proc/meminfo");
                const memTotal = memInfo.match(/MemTotal:\s+(\d+)/);
                const memAvailable = memInfo.match(/MemAvailable:\s+(\d+)/);
                
                if (memTotal && memAvailable) {
                    const total = parseInt(memTotal[1]) / 1024 / 1024;
                    const available = parseInt(memAvailable[1]) / 1024 / 1024;
                    const used = total - available;
                    document.getElementById('dashboardRam').innerText = used.toFixed(1) + ' Gb';
                }

                const cpuInfo1 = await execShell("cat /proc/stat | grep '^cpu '");
                const cpuParts1 = cpuInfo1.split(/\s+/).slice(1).map(Number);
                
                if (cpuParts1.length >= 4) {
                    await new Promise(resolve => setTimeout(resolve, 300));
                    
                    const cpuInfo2 = await execShell("cat /proc/stat | grep '^cpu '");
                    const cpuParts2 = cpuInfo2.split(/\s+/).slice(1).map(Number);
                    
                    const idle1 = cpuParts1[3];
                    const total1 = cpuParts1.reduce((a, b) => a + b, 0);
                    
                    const idle2 = cpuParts2[3];
                    const total2 = cpuParts2.reduce((a, b) => a + b, 0);
                    
                    const idleDiff = idle2 - idle1;
                    const totalDiff = total2 - total1;
                    
                    if (totalDiff > 0) {
                        const usage = ((totalDiff - idleDiff) / totalDiff * 100).toFixed(0);
                        document.getElementById('dashboardCpu').innerText = usage + '%';
                    }
                }

                const batteryLevel = await execShell("dumpsys battery | grep level");
                const level = batteryLevel.match(/\d+/);
                if (level) {
                    document.getElementById('dashboardBattery').innerText = level[0] + '%';
                }
                
                const batteryStatus = await execShell("dumpsys battery | grep status");
                const batteryIcon = document.getElementById('dashboardBatteryIcon');
                if (batteryStatus.includes('CHARGING') || batteryStatus.includes('2')) {
                    batteryIcon.innerText = 'battery_charging_full';
                } else {
                    batteryIcon.innerText = 'bedtime';
                }

                const storage = await execShell("df /data | tail -1");
                const storageParts = storage.split(/\s+/);
                if (storageParts.length >= 5) {
                    const used = parseInt(storageParts[2]) / 1024 / 1024;
                    document.getElementById('dashboardStorage').innerText = used.toFixed(1) + ' Gb';
                }

                // Update profile info di dashboard
                document.getElementById('dashboardProfile').innerText = selectedProfileMode.charAt(0).toUpperCase() + selectedProfileMode.slice(1);
                
                // Update battery usage mode di dashboard dengan icon yang sesuai
                const batteryModeIcon = document.getElementById('dashboardBatteryModeIcon');
                document.getElementById('dashboardBatteryMode').innerText = selectedBatteryMode.charAt(0).toUpperCase() + selectedBatteryMode.slice(1);
                
                if (selectedBatteryMode === 'restricted') {
                    batteryModeIcon.innerText = 'battery_alert';
                } else if (selectedBatteryMode === 'optimized') {
                    batteryModeIcon.innerText = 'battery_charging_full';
                } else if (selectedBatteryMode === 'unrestricted') {
                    batteryModeIcon.innerText = 'battery_full';
                }

                const uptime = await execShell("cat /proc/uptime | cut -d' ' -f1");
                if (uptime) {
                    const hours = Math.floor(parseInt(uptime) / 3600);
                }
            } catch (e) {
                console.error('Dashboard update error:', e);
            }
        }

        // Custom Banner Functions dengan animasi smooth
        function animateBannerChange() {
            const banner = document.getElementById('mainBanner');
            if (!banner) return;
            
            banner.style.transition = 'background-image 0.3s ease';
        }

        function openCustomBannerPage() {
            document.getElementById('customBannerPage').classList.add('open');
            document.getElementById('mainNav').classList.add('hidden');
            updateBannerSelectionUI();
        }

        function closeCustomBannerPage() {
            document.getElementById('customBannerPage').classList.remove('open');
            document.getElementById('mainNav').classList.remove('hidden');
        }

        function selectDarkBanner(index) {
            selectedDarkBanner = index;
            localStorage.setItem('astraxDarkBanner', index);
            SettingsLog.saveBanner('dark', index);
            
            if (!document.body.classList.contains('light-mode')) {
                document.documentElement.style.setProperty('--banner-url', `url('${BANNER_DARK_OPTIONS[index].url}')`);
                animateBannerChange();
            }
            
            updateBannerSelectionUI();
        }

        function selectLightBanner(index) {
            selectedLightBanner = index;
            localStorage.setItem('astraxLightBanner', index);
            SettingsLog.saveBanner('light', index);
            
            if (document.body.classList.contains('light-mode')) {
                document.documentElement.style.setProperty('--banner-url', `url('${BANNER_LIGHT_OPTIONS[index].url}')`);
                animateBannerChange();
            }
            
            updateBannerSelectionUI();
        }

        function resetBanners() {
            selectedDarkBanner = 0;
            selectedLightBanner = 0;
            localStorage.setItem('astraxDarkBanner', 0);
            localStorage.setItem('astraxLightBanner', 0);
            SettingsLog.saveBanner('dark', 0);
            SettingsLog.saveBanner('light', 0);
            
            if (document.body.classList.contains('light-mode')) {
                document.documentElement.style.setProperty('--banner-url', `url('${BANNER_LIGHT_OPTIONS[0].url}')`);
            } else {
                document.documentElement.style.setProperty('--banner-url', `url('${BANNER_DARK_OPTIONS[0].url}')`);
            }
            
            animateBannerChange();
            updateBannerSelectionUI();
        }

        function updateBannerSelectionUI() {
            for (let i = 0; i < 3; i++) {
                const el = document.getElementById(`darkBanner${i}`);
                if (el) {
                    if (i == selectedDarkBanner) {
                        el.classList.add('active');
                    } else {
                        el.classList.remove('active');
                    }
                }
            }
            
            for (let i = 0; i < 3; i++) {
                const el = document.getElementById(`lightBanner${i}`);
                if (el) {
                    if (i == selectedLightBanner) {
                        el.classList.add('active');
                    } else {
                        el.classList.remove('active');
                    }
                }
            }
        }

        // Theme dengan anti-spam 1 detik
        function toggleTheme(event) {
            if (isThemeChanging) return;
            
            isThemeChanging = true;
            
            const body = document.body;
            const isLight = body.classList.contains('light-mode');
            const themeIcon = document.getElementById('themeIcon');
            
            // Smooth transition
            if (isLight) {
                body.classList.remove('light-mode');
                themeIcon.innerText = 'dark_mode';
                localStorage.setItem('astraxTheme', 'dark');
                document.documentElement.style.setProperty('--banner-url', `url('${BANNER_DARK_OPTIONS[selectedDarkBanner].url}')`);
            } else {
                body.classList.add('light-mode');
                themeIcon.innerText = 'light_mode';
                localStorage.setItem('astraxTheme', 'light');
                document.documentElement.style.setProperty('--banner-url', `url('${BANNER_LIGHT_OPTIONS[selectedLightBanner].url}')`);
            }
            
            animateBannerChange();
            
            // Anti-spam 1 detik
            setTimeout(() => {
                isThemeChanging = false;
            }, 1000);
        }

        function loadThemePreference() {
            const savedTheme = localStorage.getItem('astraxTheme');
            const body = document.body;
            const themeIcon = document.getElementById('themeIcon');
            
            if (savedTheme === 'light') {
                body.classList.add('light-mode');
                themeIcon.innerText = 'light_mode';
                document.documentElement.style.setProperty('--banner-url', `url('${BANNER_LIGHT_OPTIONS[selectedLightBanner].url}')`);
            } else {
                body.classList.remove('light-mode');
                themeIcon.innerText = 'dark_mode';
                document.documentElement.style.setProperty('--banner-url', `url('${BANNER_DARK_OPTIONS[selectedDarkBanner].url}')`);
            }
        }

        // Home Data dengan throttling dan optimasi
        const updateHomeDataThrottled = throttle(async () => {
            const pDevice = execShell("getprop ro.product.model");
            const pChip = execShell("getprop ro.board.platform");
            const pMem = execShell("cat /proc/meminfo | grep MemTotal");
            const pKernel = execShell("uname -r");
            const pAndroid = execShell("getprop ro.build.version.release");
            const pApi = execShell("getprop ro.build.version.sdk");
            
            const [device, chip, mem, ker, android, api] = await Promise.all([pDevice, pChip, pMem, pKernel, pAndroid, pApi]);
            
            document.getElementById('deviceModel').innerText = device.trim() || "Unknown";
            document.getElementById('chipsetInfo').innerText = chip.trim() || "Unknown";
            const m = mem.match(/(\d+)/);
            if(m) document.getElementById('ramInfo').innerText = (parseInt(m[1])/1024/1024).toFixed(1)+" Gb";
            document.getElementById('kernelInfo').innerText = ker.trim() || "Unknown";
            document.getElementById('androidVer').innerText = android.trim() || "Unknown";
            document.getElementById('apiLevel').innerText = api.trim() || "Unknown";
        }, 1000);

        async function updateHomeData() {
            updateHomeDataThrottled();
        }

        // ========== PROFILE FUNCTIONS ==========
        function toggleModeSection() {
            const container = document.getElementById('modeContainer');
            const icon = document.getElementById('modeExpandIcon');
            container.classList.toggle('show');
            icon.classList.toggle('rotated');
        }

        function setSelectedMode(mode) {
            selectedProfileMode = mode;
            document.querySelectorAll('#modeContainer .mode-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`mode${mode.charAt(0).toUpperCase() + mode.slice(1)}`).classList.add('active');
            localStorage.setItem('astraxSelectedMode', mode);
            SettingsLog.saveProfile(mode);
            
            const modeIcon = document.getElementById('modeIcon');
            modeIcon.classList.add('rotated');
            setTimeout(() => modeIcon.classList.remove('rotated'), 300);
            
            // Update dashboard
            document.getElementById('dashboardProfile').innerText = mode.charAt(0).toUpperCase() + mode.slice(1);
        }

        function showApplyProfileConfirm() {
            document.getElementById('applyProfileModal').classList.add('show');
            document.getElementById('profileLoadingSpinner').style.display = 'none';
            document.getElementById('profileYesBtn').disabled = false;
            document.getElementById('profileNoBtn').disabled = false;
            document.getElementById('profileYesBtn').innerHTML = '<span class="material-symbols-rounded">check</span> Yes';
            document.getElementById('profileConfirmText').innerText = `Menerapkan Mode ${selectedProfileMode.charAt(0).toUpperCase() + selectedProfileMode.slice(1)}?`;
        }

        function cancelApplyProfile() {
            if (profileApplyTimerInterval) clearInterval(profileApplyTimerInterval);
            document.getElementById('applyProfileModal').classList.remove('show');
        }

        async function confirmApplyProfile() {
            const yesBtn = document.getElementById('profileYesBtn');
            const noBtn = document.getElementById('profileNoBtn');
            const spinner = document.getElementById('profileLoadingSpinner');
            
            yesBtn.disabled = true;
            noBtn.disabled = true;
            yesBtn.innerHTML = '<span class="material-symbols-rounded rotating">progress_activity</span> Applying...';
            spinner.style.display = 'flex';
            
            try {
                let commands = [];
                
                if (selectedProfileMode === 'battery') {
                    commands = [
                        `cmd power set-fixed-performance-mode-enabled false`,
                        `cmd power set-adaptive-power-saver-enabled true`,
                        `cmd power set-mode 1`,
                        `settings delete global activity_manager_constants`,
                        `settings delete system device_idle_constants`,
                        `settings put global activity_manager_constants max_cached_processes=160,background_settle_time=10000,gc_timeout=60000,gc_min_interval=60000,full_pss_min_interval=300000,full_pss_lowered_interval=300000,power_check_interval=90000,service_restart_duration=2000,service_min_restart_time_between=3000,service_bg_start_timeout=15000,service_bg_activity_start_timeout=15000,process_start_async=true`,
                        `settings put system device_idle_constants inactive_to=600000,idle_after_inactive_to=1200000,idle_pending_to=600000,idle_factor=2`,
                        `settings put global app_standby_enabled 1`,
                        `settings put global forced_app_standby_enabled 1`,
                        `settings put global forced_app_standby_for_small_battery_enabled 1`,
                        `settings put global force_background_check 1`,
                        `settings put global background_check_enabled 1`,
                        `settings put global adaptive_battery_management_enabled 1`,
                        `settings put global app_auto_restriction_enabled 1`,
                        `settings put global app_restriction_enabled 1`,
                        `settings put global cached_apps_freezer 1`,
                        `settings put global low_power 1`,
                        `settings put global dynamic_power_savings_enabled 1`
                    ];
                } else if (selectedProfileMode === 'balance') {
                    commands = [
                        `cmd power set-fixed-performance-mode-enabled false`,
                        `cmd power set-adaptive-power-saver-enabled true`,
                        `cmd power set-mode 0`,
                        `settings delete global activity_manager_constants`,
                        `settings delete system device_idle_constants`,
                        `settings delete global app_standby_enabled`,
                        `settings delete global forced_app_standby_enabled`,
                        `settings delete global forced_app_standby_for_small_battery_enabled`,
                        `settings delete global force_background_check`,
                        `settings delete global background_check_enabled`,
                        `settings delete global adaptive_battery_management_enabled`,
                        `settings delete global app_auto_restriction_enabled`,
                        `settings delete global app_restriction_enabled`,
                        `settings delete global cached_apps_freezer`,
                        `settings delete global low_power`,
                        `settings delete global dynamic_power_savings_enabled`,
                        `settings put global activity_manager_constants max_cached_processes=256,background_settle_time=5000,gc_timeout=60000,gc_min_interval=60000,full_pss_min_interval=300000,full_pss_lowered_interval=300000,power_check_interval=60000,service_restart_duration=1000,service_min_restart_time_between=2000,service_bg_start_timeout=10000,service_bg_activity_start_timeout=10000,process_start_async=true`,
                        `settings put system device_idle_constants inactive_to=1200000,idle_after_inactive_to=2400000,idle_pending_to=1200000,idle_factor=3`
                    ];
                } else if (selectedProfileMode === 'performance') {
                    commands = [
                        `cmd power set-adaptive-power-saver-enabled false`,
                        `cmd power set-fixed-performance-mode-enabled true`,
                        `cmd power set-mode 0`,
                        `settings delete global activity_manager_constants`,
                        `settings delete system device_idle_constants`,
                        `settings delete global app_standby_enabled`,
                        `settings delete global forced_app_standby_enabled`,
                        `settings delete global forced_app_standby_for_small_battery_enabled`,
                        `settings delete global force_background_check`,
                        `settings delete global background_check_enabled`,
                        `settings delete global adaptive_battery_management_enabled`,
                        `settings delete global app_auto_restriction_enabled`,
                        `settings delete global app_restriction_enabled`,
                        `settings delete global cached_apps_freezer`,
                        `settings delete global dynamic_power_savings_enabled`,
                        `settings put global low_power 0`,
                        `settings put global activity_manager_constants max_cached_processes=384,background_settle_time=2000,gc_timeout=90000,gc_min_interval=90000,full_pss_min_interval=600000,full_pss_lowered_interval=600000,power_check_interval=60000,service_restart_duration=800,service_min_restart_time_between=1200,service_bg_start_timeout=8000,service_bg_activity_start_timeout=8000,process_start_async=true`,
                        `settings put system device_idle_constants inactive_to=1800000,idle_after_inactive_to=3600000,idle_pending_to=1800000,idle_factor=4`
                    ];
                }
                
                for (const cmd of commands) {
                    await execShell(cmd);
                }
                
                showToast(`${selectedProfileMode.charAt(0).toUpperCase() + selectedProfileMode.slice(1)} Mode Applied`);
                
                // Update dashboard
                document.getElementById('dashboardProfile').innerText = selectedProfileMode.charAt(0).toUpperCase() + selectedProfileMode.slice(1);
                
            } catch (error) {
                console.error('Error applying profile:', error);
                showToast('Failed To Apply Profile', false);
            } finally {
                document.getElementById('applyProfileModal').classList.remove('show');
                yesBtn.disabled = false;
                noBtn.disabled = false;
                yesBtn.innerHTML = '<span class="material-symbols-rounded">check</span> Yes';
                spinner.style.display = 'none';
            }
        }

        async function resetMode() {
            setSelectedMode('balance');
            await confirmApplyProfile();
        }

        function loadModeState() {
            const savedMode = localStorage.getItem('astraxSelectedMode') || SettingsLog.getLog().profile;
            if (savedMode) {
                selectedProfileMode = savedMode;
                setSelectedMode(savedMode);
            } else {
                setSelectedMode('balance');
            }
        }

        // Sensitivity Functions
        function updateSensitivityValue(val) {
            document.getElementById('sensitivityValue').innerText = val;
            SettingsLog.saveSensitivity(parseInt(val));
        }

        async function applySensitivity() {
            const val = document.getElementById('sensitivitySlider').value;
            await execShell(`settings put system pointer_speed ${val}`);
            SettingsLog.saveSensitivity(parseInt(val));
            showToast(`Sensitivity Set To ${val}`);
        }

        async function resetSensitivity() {
            await execShell('settings delete system pointer_speed');
            document.getElementById('sensitivitySlider').value = 4;
            document.getElementById('sensitivityValue').innerText = '4';
            SettingsLog.saveSensitivity(4);
            showToast('Reset To Default');
        }

        // Battery Usage Functions
        function openBatteryPage() {
            document.getElementById('batteryPage').classList.add('open');
            document.getElementById('mainNav').classList.add('hidden');
            // Load saved mode
            const savedMode = localStorage.getItem('astraxBatteryMode') || SettingsLog.getLog().batteryMode;
            setSelectedBatteryMode(savedMode);
        }

        function closeBatteryPage() {
            document.getElementById('batteryPage').classList.remove('open');
            document.getElementById('mainNav').classList.remove('hidden');
        }

        function toggleBatterySection() {
            const container = document.getElementById('batteryContainer');
            const icon = document.getElementById('batteryExpandIcon');
            container.classList.toggle('show');
            icon.classList.toggle('rotated');
        }

        function setSelectedBatteryMode(mode) {
            selectedBatteryMode = mode;
            
            document.getElementById('batteryModeRestrictedIcon').style.color = 'transparent';
            document.getElementById('batteryModeOptimizedIcon').style.color = 'transparent';
            document.getElementById('batteryModeUnrestrictedIcon').style.color = 'transparent';
            document.getElementById('batteryModeRestrictedIcon').innerText = 'radio_button_unchecked';
            document.getElementById('batteryModeOptimizedIcon').innerText = 'radio_button_unchecked';
            document.getElementById('batteryModeUnrestrictedIcon').innerText = 'radio_button_unchecked';
            
            if (mode === 'restricted') {
                document.getElementById('batteryModeRestrictedIcon').style.color = 'var(--md-primary)';
                document.getElementById('batteryModeRestrictedIcon').innerText = 'check_circle';
            } else if (mode === 'optimized') {
                document.getElementById('batteryModeOptimizedIcon').style.color = 'var(--md-primary)';
                document.getElementById('batteryModeOptimizedIcon').innerText = 'check_circle';
            } else if (mode === 'unrestricted') {
                document.getElementById('batteryModeUnrestrictedIcon').style.color = 'var(--md-primary)';
                document.getElementById('batteryModeUnrestrictedIcon').innerText = 'check_circle';
            }
            
            document.getElementById('applyBatteryBtn').disabled = false;
            
            // Update dashboard
            const batteryModeIcon = document.getElementById('dashboardBatteryModeIcon');
            document.getElementById('dashboardBatteryMode').innerText = mode.charAt(0).toUpperCase() + mode.slice(1);
            
            if (mode === 'restricted') {
                batteryModeIcon.innerText = 'battery_alert';
            } else if (mode === 'optimized') {
                batteryModeIcon.innerText = 'battery_charging_full';
            } else if (mode === 'unrestricted') {
                batteryModeIcon.innerText = 'battery_full';
            }
            
            // Save to storage
            localStorage.setItem('astraxBatteryMode', mode);
            SettingsLog.saveBatteryMode(mode);
        }

        function showApplyBatteryConfirm() {
            document.getElementById('applyBatteryModal').classList.add('show');
            document.getElementById('batteryLoadingSpinner').style.display = 'none';
            document.getElementById('batteryYesBtn').disabled = false;
            document.getElementById('batteryYesBtn').innerHTML = '<span class="material-symbols-rounded">check</span> Yes';
        }

        function cancelApplyBattery() {
            if (batteryApplyTimerInterval) clearInterval(batteryApplyTimerInterval);
            document.getElementById('applyBatteryModal').classList.remove('show');
        }

        async function confirmApplyBattery() {
            const yesBtn = document.getElementById('batteryYesBtn');
            const noBtn = document.getElementById('batteryNoBtn');
            const spinner = document.getElementById('batteryLoadingSpinner');
            
            yesBtn.disabled = true;
            noBtn.disabled = true;
            yesBtn.innerHTML = '<span class="material-symbols-rounded rotating">progress_activity</span> Applying...';
            spinner.style.display = 'flex';
            
            try {
                console.log(`Applying battery mode: ${selectedBatteryMode}`);
                
                if (selectedBatteryMode === 'restricted') {
                    await execShell("cmd power set-mode 1");
                } else if (selectedBatteryMode === 'optimized') {
                    await execShell("cmd power set-mode 0");
                } else if (selectedBatteryMode === 'unrestricted') {
                    await execShell("cmd power set-fixed-performance-mode-enabled true");
                }
                
                showToast(`âœ… Battery Mode Applied: ${selectedBatteryMode.charAt(0).toUpperCase() + selectedBatteryMode.slice(1)}`, true);
                
                // Update dashboard
                const batteryModeIcon = document.getElementById('dashboardBatteryModeIcon');
                document.getElementById('dashboardBatteryMode').innerText = selectedBatteryMode.charAt(0).toUpperCase() + selectedBatteryMode.slice(1);
                
                if (selectedBatteryMode === 'restricted') {
                    batteryModeIcon.innerText = 'battery_alert';
                } else if (selectedBatteryMode === 'optimized') {
                    batteryModeIcon.innerText = 'battery_charging_full';
                } else if (selectedBatteryMode === 'unrestricted') {
                    batteryModeIcon.innerText = 'battery_full';
                }
                
                // Save to storage
                localStorage.setItem('astraxBatteryMode', selectedBatteryMode);
                SettingsLog.saveBatteryMode(selectedBatteryMode);
                
            } catch (error) {
                console.error('Error applying battery mode:', error);
                showToast('Failed To Apply Battery Mode', false);
            } finally {
                document.getElementById('applyBatteryModal').classList.remove('show');
                yesBtn.disabled = false;
                noBtn.disabled = false;
                yesBtn.innerHTML = '<span class="material-symbols-rounded">check</span> Yes';
                spinner.style.display = 'none';
            }
        }

        // Page Navigation
        function openResPage() { 
            document.getElementById('resPage').classList.add('open'); 
            document.getElementById('mainNav').classList.add('hidden'); 
            fetchCurrentRes();
        }
        function closeResPage() { 
            document.getElementById('resPage').classList.remove('open'); 
            document.getElementById('mainNav').classList.remove('hidden'); 
        }
        
        function openModePage() { 
            document.getElementById('modePage').classList.add('open'); 
            document.getElementById('mainNav').classList.add('hidden'); 
        }
        function closeModePage() { 
            document.getElementById('modePage').classList.remove('open'); 
            document.getElementById('mainNav').classList.remove('hidden'); 
        }

        function openSensitivityPage() {
            document.getElementById('sensitivityPage').classList.add('open');
            document.getElementById('mainNav').classList.add('hidden');
            execShell('settings get system pointer_speed').then(val => {
                const speed = parseInt(val.trim());
                if (!isNaN(speed) && speed >= 1 && speed <= 7) {
                    document.getElementById('sensitivitySlider').value = speed;
                    document.getElementById('sensitivityValue').innerText = speed;
                } else {
                    document.getElementById('sensitivitySlider').value = 4;
                    document.getElementById('sensitivityValue').innerText = '4';
                }
            });
        }
        function closeSensitivityPage() {
            document.getElementById('sensitivityPage').classList.remove('open');
            document.getElementById('mainNav').classList.remove('hidden');
        }

        // Resolution Functions
        const MAX_RES = 3800;
        const MIN_WIDTH = 600;
        const MIN_HEIGHT = 600;
        let pendingResolution = { w: 0, h: 0 };
        
        async function fetchCurrentRes() {
            try {
                const sizeRaw = await execShell("wm size"); 
                const sizeMatch = sizeRaw.match(/(\d+)x(\d+)/);
                if(sizeMatch) {
                    let width = parseInt(sizeMatch[1]);
                    let height = parseInt(sizeMatch[2]);
                    
                    if (width > MAX_RES) width = MAX_RES;
                    if (height > MAX_RES) height = MAX_RES;
                    
                    document.getElementById('resW').value = width;
                    document.getElementById('resH').value = height;
                }
            } catch(e) {}
        }

        function toggleResSection() {
            const container = document.getElementById('resContainer');
            const icon = document.getElementById('resExpandIcon');
            container.classList.toggle('show');
            icon.classList.toggle('rotated');
        }

        function showApplyResolutionConfirm() {
            let w = parseInt(document.getElementById('resW').value);
            let h = parseInt(document.getElementById('resH').value);
            
            if (isNaN(w) || w < MIN_WIDTH) w = MIN_WIDTH;
            if (isNaN(h) || h < MIN_HEIGHT) h = MIN_HEIGHT;
            if (w > MAX_RES) w = MAX_RES;
            if (h > MAX_RES) h = MAX_RES;
            
            document.getElementById('resW').value = w;
            document.getElementById('resH').value = h;
            
            pendingResolution = { w, h };
            document.getElementById('applyModalResolutionText').innerText = `${w}x${h}`;
            
            applyTimerValue = 10;
            document.getElementById('applyTimer').innerText = applyTimerValue;
            document.getElementById('applyYesBtn').disabled = true;
            
            if (applyTimerInterval) clearInterval(applyTimerInterval);
            applyTimerInterval = setInterval(() => {
                applyTimerValue--;
                document.getElementById('applyTimer').innerText = applyTimerValue;
                
                if (applyTimerValue <= 0) {
                    clearInterval(applyTimerInterval);
                    document.getElementById('applyYesBtn').disabled = false;
                }
            }, 1000);
            
            document.getElementById('applyResolutionModal').classList.add('show');
        }

        function showResetResolutionConfirm() {
            resetTimerValue = 10;
            document.getElementById('resetTimer').innerText = resetTimerValue;
            document.getElementById('resetYesBtn').disabled = true;
            
            if (resetTimerInterval) clearInterval(resetTimerInterval);
            resetTimerInterval = setInterval(() => {
                resetTimerValue--;
                document.getElementById('resetTimer').innerText = resetTimerValue;
                
                if (resetTimerValue <= 0) {
                    clearInterval(resetTimerInterval);
                    document.getElementById('resetYesBtn').disabled = false;
                }
            }, 1000);
            
            document.getElementById('resetResolutionModal').classList.add('show');
        }

        async function confirmApplyResolution() {
            if (applyTimerInterval) clearInterval(applyTimerInterval);
            document.getElementById('applyResolutionModal').classList.remove('show');
            await execShell(`wm size ${pendingResolution.w}x${pendingResolution.h}`);
            SettingsLog.saveResolution(pendingResolution.w, pendingResolution.h);
            showToast(`Resolusi: ${pendingResolution.w}x${pendingResolution.h}`);
        }

        function cancelApplyResolution() {
            if (applyTimerInterval) clearInterval(applyTimerInterval);
            document.getElementById('applyResolutionModal').classList.remove('show');
            showToast('Dibatalkan');
        }

        async function confirmResetResolution() {
            if (resetTimerInterval) clearInterval(resetTimerInterval);
            document.getElementById('resetResolutionModal').classList.remove('show');
            await execShell("wm size reset");
            fetchCurrentRes();
            showToast('Resolusi Default');
        }

        function cancelResetResolution() {
            if (resetTimerInterval) clearInterval(resetTimerInterval);
            document.getElementById('resetResolutionModal').classList.remove('show');
            showToast('Reset Dibatalkan');
        }

        // Load saved battery mode
        function loadBatteryModeState() {
            const savedBatteryMode = localStorage.getItem('astraxBatteryMode') || SettingsLog.getLog().batteryMode;
            if (savedBatteryMode) {
                setSelectedBatteryMode(savedBatteryMode);
            } else {
                setSelectedBatteryMode('optimized');
            }
        }

        // Save battery mode when applied
        function saveBatteryMode(mode) {
            localStorage.setItem('astraxBatteryMode', mode);
        }

        // Optimasi performa dengan requestAnimationFrame
        function optimizeAnimations() {
            let ticking = false;
            document.addEventListener('scroll', () => {
                if (!ticking) {
                    window.requestAnimationFrame(() => {
                        ticking = false;
                    });
                    ticking = true;
                }
            }, { passive: true });
        }

        // Init
        window.onload = function() {
            // Load semua settings dari log
            SettingsLog.loadAllSettings();
            
            loadThemePreference();
            updateHomeData();
            loadModeState();
            loadBatteryModeState();
            updateBannerSelectionUI();
            switchTab(0);
            optimizeAnimations();
            
            // Preload gambar banner untuk performa lebih baik
            const preloadImages = () => {
                const imagesToPreload = [
                    ...BANNER_DARK_OPTIONS.map(b => b.url),
                    ...BANNER_LIGHT_OPTIONS.map(b => b.url)
                ];
                imagesToPreload.forEach(url => {
                    const img = new Image();
                    img.src = url;
                });
            };
            
            // Delay preload agar tidak mengganggu render awal
            setTimeout(preloadImages, 2000);
        }
    </script>
</body>
</html>
